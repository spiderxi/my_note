# 1. 分布式数据库

## 1. 分片

_讲一下一致性 hash 算法, 有什么优点?_

```
c_hash()函数的值域形成一个哈希环(), 节点和记录通过chash()映射到环上一点(节点也可以映射到多个虚拟点上), 每条记录点找到顺时针最近的点对应的节点作为存储节点

优点: 节点数量变换时只需要在少量节点间进行数据迁移
```

_范围分片(Range Sharding)和哈希分片(Hash Sharding)的区别?_

```
* 哈希分片: 通过 c_hash(key)所在范围决定节点, 节点负载更均衡

* 范围分片: 通过key所在范围决定节点
```

_如何解决水平分表和垂直分表带来的查询问题?_

## 2. 复制

_讲一下分布式系统的一致性模型?_

```
一致性从强到弱分别为:
1. 线性一致性(linearizability)
写入操作会立刻在全部节点生效

2. 顺序一致性(sequential consistency)
写入操作被放到一个FIFO队列中, 可以延迟写入

3. 因果一致性
happens-before

4. 最终一致性(eventual consistency)
```

_主从节点间同步数据的复制方式分为哪三种?_

```
* 同步复制: 主节点等待所有从节点写入完成才响应客户端

* 异步复制: 主节点写入完成后直接响应客户端, 再讲数据写入到从节点

* 半同步复制: 主节点等待一定数量的从节点写入完成就响应客户端
```

如何解决多主节点时写入的数据冲突?

```
同一条记录按照key映射到一个主节点,  只在这个主节点写入
```

_什么是 Quorum 数据冗余机制?_

```
在N个无主节点的副本集群中, 假设每次写入至少需要W个节点成功, 每次读至少从R个节点读, 那么需要满足:
W + R > N
```

## 3. 分布式理论

_如何证明 CAP 理论?_

```
反证: 假设存在CAP三者满足的分布式系统, 当出现网络分区时向一个分区写入X新值, 从另一个分区读X, 必然出现不一致
```

_PACELC 理论的内容?_

```
* 当出现网络分区时分布式系统必须在CA之间权衡

* 当没有出现网络分区时分布式系统必须在一致性(C)和延迟(L)之间权衡
```

# 2. 共识算法

## 1. Paxos

_FLP?_

## 2. Raft
