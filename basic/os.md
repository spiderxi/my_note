# 1. 操作系统概述

***从按下电源键, 到操作系统启动过程是怎样的?***

```
1. 将ROM中的BIOS程序加载到内存中开始执行
2. BIOS会测试硬件
3. 通过MBR(一个寄存器)找到bootloader程序地址, 负责将OS程序加载到内存中
4. OS接管计算机
```

***中断的执行过程?***

```
1. 关中断标志位, 保存CPU寄存器的值和进程的栈(保存进程上下文)
2. 开中断标志位, 执行中断处理程序
3. 关中断标志位, 恢复进程上下文
4. 开中断
```

***什么是硬中断, 什么是软中断?***

```
硬件发起的中断请求叫做硬中断, 用户进程发起的中断请求叫做软中断
```

# 2. 进程

## 1 进程概述

***一个进程的状态有哪些?***

![1680579221678](image/操作系统/1680579221678.png)

***进程间通信方式有哪些?***

```
* 共享内存: 操作系统在内核区开辟一个多个进程可以访问的区域
* 消息队列: 操作系统在内核维护消息链表, 链表可以被多个进程访问
* 管道: 操作系统创建一个pipe文件, 用于半双工通信
* 信号量: 操作系统提供的互斥操作, 访问临界区时先P操作, 后V操作
* 信号: linux操作系统中, 一个进程在收到信号后会进行响应的处理
* Socket: 本质是文件IO
```

## 2. 线程和协程

***用户级线程和内核级线程区别和映射关系?***

```
* 用户级线程是用户进程自己创建和维护的, 当进程只使用一个CPU核心时这些线程是并发的
* 内核级线程是操作系统创建和维护的, 多个内核级线程可以在多个核心上并行执行

映射关系:
1:1 N:1 N:M
```

***进程, 线程, 协程的区别?***

```
* 进程是操作系统分配系统资源的单位, 一个可执行文件被加载到内存中后会作为进程

* 线程是轻量级的进程, 线程可以共享进程的资源

* 协程是用户级线程, 协程的上下文切换由用户程序自己控制
```

## 3. 进程调度

***进程调度算法有哪些?***

```
* 先来先服务
* 短作业有限
* 高响应比任务优先
* 按优先级调度
* 时间片轮转调度
* 多级反馈队列
```

***多级反馈队列调度调度是什么?***

```
* 多个进程就绪队列, 不同队列之间有优先级
* 优先级高的队列使用时间片短的RR算法
* 优先级低的队列使用时间片长度RR算法
* 时间片内未执行完的任务会被放到优先级低的就绪队列中
```

## 4. 进程的系统调用

***fork()的作用?***

```
* 父进程在fork() 后会创建相同内存映像的子进程
* fork在父进程中返回值为子进程pid
* fork在子进程中返回值为0
```

***什么是僵尸进程, 内核如何防止僵尸进程过多?***

```
* 一个子进程在终止之后会变成僵尸进程, 只保留一些进程信息
* 父进程调用wait()/waitpid()获取僵尸进程的状态后僵尸进程才会被移除
* 一个子进程终止时, 会将其父进程设置为init, init进程会周期性等待所有进程
```

## 5.死锁

***什么是死锁, 死锁的四个必要条件?***

```
多个进程之间的资源等待链形成环导致每个进程都阻塞的情况, 死锁的形成有四个条件:
1. 资源是互斥的, 不能多个进程共享
2. 进程是不可剥夺的, 不能强制终止进程
3. 进程持有资源且在等待其他资源
4. 资源等待链形成环

```

***如何避免死锁?***

```
*. 银行家算法确保存在一个安全序列
*. 申请到所以资源在执行
*. 等待锁的时间过长时直接剥夺执行权
```

***如果解决死锁?***

```
* 鸵鸟策略: 不管死锁, 当进程时间片用完会被强制剥夺CPU
* 维护资源依赖图, 当检测到图中有环时, 强制剥夺环中一个进程的执行权
```

# 3. 存储管理

## 1. 虚拟地址技术

***什么是虚拟地址技术?***

每个进程使用虚拟地址空间(从0开始), 通过MMU将虚拟地址映射为主存的物理地址

```
* 虚拟地址空间只有在被用到时才会被分配物理地址空间
* 虚拟地址空间可以大于内存, 操作系统会使用磁盘上的Swap区交换不常用的页面到磁盘
```

![1693378143989](image/操作系统/1693378143989.png)

***讲一下段式存储器, 有什么缺点?***

段式存储将一个进程的内存分为多个段

```
* 虚拟地址分为段号和段内偏移, 通过段号获取到段表中的段表项
* 每个段表项包含: 段在主存中的基址, 段的长度
* 物理地址 = 使用基址+段内偏移
```

缺点: 容易产生内存外部碎片, 当外部碎片过多时, 需要将段存储到外存Swap区, 然后在重新加载到内存用来去除外部碎片

![1693379212164](image/操作系统/1693379212164.png)

***讲一下页式存储器?***

```
* 内存被分为4kb固定大小的页
* 虚拟地址由虚拟页号和页内偏移组成
* 通过页表将虚拟页号转为物理页号
* 当访问虚拟页并发现虚拟页在内存中无对应的物理页时, 会将部分物理页换出到磁盘Swap区获取闲置的物理页, 当需要使用被换出的页时, 发生缺页中断, 从Swap中换入
```

![1693378993246](image/操作系统/1693378993246.png)

***为什么使用多级页表, 为什么使用TLB(快表)?***

```
* TLB是保存在cache中的部分页表, 用于加速页表项的查找
* 如果使用一级页表页表项过多, 页表太大, 使用多级页表时, 未使用到的高级页表项可以不创建低级页表
```

***什么是段页式存储?***

将进程使用的内存分为段, 各个段再分为固定大小的页, 虚拟地址由 `段号 + 页号 + 页内偏移组成`

## 2 页面置换算法

***页面置换算法有哪些?***

```
* FIFO: 替换最先进入内存的页面
* LRU
* LFU
* OPT: 理论上的最佳置换算法, 替换以后最长时间不会被使用的页
* CLOCK: 所有物理页形成一个环形链表, 需要置换页面时循环扫描物理页,  两次扫描后期间页面没有被使用过, 则替换
```

***LRU算法如何解决缓存污染的问题?***

```
* 将LRU链表分为活跃区和不活跃区
* 一个页面被访问时先进入不活跃区
* 在不活跃区被频繁访问后才进入活跃区
```

![1693381161962](image/操作系统/1693381161962.png)

## 3 抖动现象和Belady异常

***什么是抖动现象?***

当操作系统给进程分配的最大物理页数量小于进程常用的页的数量时, 会频繁地发生缺页中断, 这种现象叫做抖动

***什么是Balady异常?***

页面置换算法使用FIFO时, 给进程分配更多的页时缺页率反而上升的异常现象

# 4. 磁盘和文件系统

## 1 文件系统

***什么是硬链接, 什么是软连接, 什么是inode?***

```
* inode: 每个文件都有一个inode, 包含文件的元信息
* 硬链接指文件目录中的一个文件项直接指向inode
* 软链接指文件目录中的一个文件项, 文件项硬链接的文件的内容是指向其他文件的inode的指针
```

***ext2和ext3文件系统的区别?***

```
ext3支持日志, 且当系统宕机时文件系统不会损坏
```

***什么是PageCache?***

```
* PageCache指内核区操作系统用于文件io的缓冲页
* 使用系统调用fsync()可以强制刷新脏数据到文件
```

## 2 磁盘

***磁盘调度算法有哪些?***

```
* 先来先服务
* 最短寻道时间优先
* SCAN扫描算法: 磁头在最小磁道和最大磁道之间来回移动
* LOOK算法: 磁头在最小请求磁道和最大请求磁道之间来回移动
* C-SCAN, C-LOOK: 磁头不来回移动, 在移动到一端后立刻返回另一端
```

***使用DMA的好处?***

```
* 当遇到IO请求时, CPU将请求发送给DMA, 避免CPU阻塞
* DMA控制: 内核缓冲区和IO接口缓冲区之间的数据IO过程
```

***键盘上输入一个字符后会发生什么?***

# 5. linux命令

***常用的Linux指令有哪些?***

```
ipconfig: 查看网络配置
netstat: 查看被监听的端口和对应的监听进程
cat, less, more, head, tail: 查看日志文件
grep: 过滤出包含关键字的行
wc: 统计文件的行数/字数
sort: 按照行排序
uniq: 删除重复的行, 保留唯一的行
awk '{print $1}' fileName: 执行脚本, 经常被用来做文本过滤, 过滤不需要的列
chmod: 改变文件权限
touch/rm: 新建一个文件/删除一个文件
mv: 移动文件/重命名
```
